
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pure Parsing &#8212; PyMD4C  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="DOM Parsing" href="dom_parsing.html" />
    <link rel="prev" title="Generating HTML" href="generating_html.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyMD4C</a></h1>



<p class="blurb">Python bindings for MD4C</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="generating_html.html">Generating HTML</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pure Parsing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sax-like-parsing">SAX-Like Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#entity-helper">Entity Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#object-oriented-parsing">Object-Oriented Parsing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dom_parsing.html">DOM Parsing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="dom_api.html">DOM API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to PyMD4C</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="generating_html.html" title="previous chapter">Generating HTML</a></li>
      <li>Next: <a href="dom_parsing.html" title="next chapter">DOM Parsing</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pure-parsing">
<h1>Pure Parsing<a class="headerlink" href="#pure-parsing" title="Permalink to this headline">¶</a></h1>
<section id="sax-like-parsing">
<h2>SAX-Like Parsing<a class="headerlink" href="#sax-like-parsing" title="Permalink to this headline">¶</a></h2>
<p>Applications that want to do their own rendering or don’t need to generate
output at all can use the <a class="reference internal" href="api.html#md4c.GenericParser" title="md4c.GenericParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericParser</span></code></a> class. It is implemented
in C on top of the bare MD4C parser and provides a similar SAX-like interface.</p>
<p>Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">md4c</span>

<span class="c1"># Counters</span>

<span class="n">block_counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">span_counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">char_count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Callbacks</span>

<span class="k">def</span> <span class="nf">enter_block</span><span class="p">(</span><span class="n">block_type</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">block_counts</span><span class="p">[</span><span class="n">block_type</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">block_counts</span><span class="p">[</span><span class="n">block_type</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">leave_block</span><span class="p">(</span><span class="n">block_type</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">enter_span</span><span class="p">(</span><span class="n">span_type</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">span_counts</span><span class="p">[</span><span class="n">span_type</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">span_counts</span><span class="p">[</span><span class="n">span_type</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">leave_span</span><span class="p">(</span><span class="n">span_type</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">process_text</span><span class="p">(</span><span class="n">text_type</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">char_count</span>
    <span class="n">char_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="c1"># Parsing</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;README.md&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">markdown</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">md4c</span><span class="o">.</span><span class="n">GenericParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span>
             <span class="n">enter_block</span><span class="p">,</span> <span class="n">leave_block</span><span class="p">,</span>
             <span class="n">enter_span</span><span class="p">,</span> <span class="n">leave_span</span><span class="p">,</span>
             <span class="n">process_text</span><span class="p">)</span>

<span class="k">for</span> <span class="n">block_type</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">block_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">block_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="k">for</span> <span class="n">span_type</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">span_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">span_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characters&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">char_count</span><span class="p">)</span>
</pre></div>
</div>
<p>This counts the number of each type of Markdown element and the total number of
displayed characters and prints a summary at the end.</p>
<p>There is a fair amount to digest here, so let’s break it into parts.</p>
<section id="constructing-the-parser">
<h3>Constructing the Parser<a class="headerlink" href="#constructing-the-parser" title="Permalink to this headline">¶</a></h3>
<p>We will come back to the callbacks defined at the beginning of the code. The
first step in the actual parsing is to construct a parser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">md4c</span><span class="o">.</span><span class="n">GenericParser</span><span class="p">()</span>
</pre></div>
</div>
<p>Much like the <a class="reference internal" href="api.html#md4c.HTMLRenderer" title="md4c.HTMLRenderer"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTMLRenderer</span></code></a>, the constructor accepts options (see
<a class="reference internal" href="api.html#options"><span class="std std-ref">Option Flags</span></a>), either through keyword arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">md4c</span><span class="o">.</span><span class="n">GenericParser</span><span class="p">(</span><span class="n">tables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">strikethrough</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>or a positional argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">md4c</span><span class="o">.</span><span class="n">GenericParser</span><span class="p">(</span>
    <span class="n">md4c</span><span class="o">.</span><span class="n">MD_FLAG_TABLES</span> <span class="o">|</span> <span class="n">md4c</span><span class="o">.</span><span class="n">MD_FLAG_STRIKETHROUGH</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that only the parser options are accepted, since there is no rendering
(this is why there is only one positional argument).</p>
</section>
<section id="actual-parsing">
<h3>Actual Parsing<a class="headerlink" href="#actual-parsing" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="api.html#md4c.GenericParser.parse" title="md4c.GenericParser.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parse()</span></code></a> method does the actual parsing. This is
where “SAX-like” comes into play: Rather than producing an abstract syntax tree
in memory, MD4C provides a callback interface. As it digests the Markdown
document from top to bottom, it calls a callback for any of these five events:</p>
<ul class="simple">
<li><p>Entering a new block</p></li>
<li><p>Leaving a block</p></li>
<li><p>Entering a new inline/span</p></li>
<li><p>Leaving an inline/span</p></li>
<li><p>Adding text inside the current element</p></li>
</ul>
<p>Accordingly, the <a class="reference internal" href="api.html#md4c.GenericParser.parse" title="md4c.GenericParser.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parse()</span></code></a> call in the example above
has six parameters. The first is the Markdown document to parse, and the other
five are the functions to use as callbacks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">markdown</span><span class="p">,</span>
             <span class="n">enter_block</span><span class="p">,</span> <span class="n">leave_block</span><span class="p">,</span>
             <span class="n">enter_span</span><span class="p">,</span> <span class="n">leave_span</span><span class="p">,</span>
             <span class="n">process_text</span><span class="p">)</span>
</pre></div>
</div>
<p>The Markdown document may be a <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>, whichever is
convenient. The parsed text will be provided using the same type.</p>
<p>Now, let’s look at how the callbacks work.</p>
</section>
<section id="callbacks">
<span id="id1"></span><h3>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h3>
<p>Each <a class="reference internal" href="api.html#md4c.GenericParser.parse" title="md4c.GenericParser.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parse()</span></code></a> call requires five callbacks:</p>
<dl class="py function">
<dt class="sig sig-object py" id="enter_block_callback">
<span class="sig-name descname"><span class="pre">enter_block_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">details</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#enter_block_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Called whenever MD4C enters a new block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block_type</strong> – An instance of <a class="reference internal" href="api.html#md4c.BlockType" title="md4c.BlockType"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlockType</span></code></a></p></li>
<li><p><strong>details</strong> – The details dict</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="leave_block_callback">
<span class="sig-name descname"><span class="pre">leave_block_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">details</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#leave_block_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Called whenever MD4C leaves a block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block_type</strong> – An instance of <a class="reference internal" href="api.html#md4c.BlockType" title="md4c.BlockType"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlockType</span></code></a></p></li>
<li><p><strong>details</strong> – The details dict</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="enter_span_callback">
<span class="sig-name descname"><span class="pre">enter_span_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">span_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">details</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#enter_span_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Called whenever MD4C enters a new span/inline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>span_type</strong> – An instance of <a class="reference internal" href="api.html#md4c.SpanType" title="md4c.SpanType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanType</span></code></a></p></li>
<li><p><strong>details</strong> – The details dict</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="leave_span_callback">
<span class="sig-name descname"><span class="pre">leave_span_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">span_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">details</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#leave_span_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Called whenever MD4C leaves a span/inline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>span_type</strong> – An instance of <a class="reference internal" href="api.html#md4c.SpanType" title="md4c.SpanType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanType</span></code></a></p></li>
<li><p><strong>details</strong> – The details dict</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="text_callback">
<span class="sig-name descname"><span class="pre">text_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#text_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Called whenever MD4C has text to add to the current block or inline element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text_type</strong> – An instance of <a class="reference internal" href="api.html#md4c.TextType" title="md4c.TextType"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextType</span></code></a></p></li>
<li><p><strong>text</strong> – A string or bytes containing the text to be added</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>The first four callbacks work similarly. All must accept a
<a class="reference internal" href="api.html#md4c.BlockType" title="md4c.BlockType"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlockType</span></code></a> or <a class="reference internal" href="api.html#md4c.SpanType" title="md4c.SpanType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanType</span></code></a> as their first parameter
and a details dict as their second parameter. The details dict is described
in the next section, but it is how additional properties of the element are
provided, such as a heading’s label or a link’s destination. If you were
writing your own rendering code, these callbacks would write opening or closing
HTML tags to the output stream.</p>
<p>The fifth callback accepts a <a class="reference internal" href="api.html#md4c.TextType" title="md4c.TextType"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextType</span></code></a> as the first parameter
and some text as the second parameter. The text’s type will match that of the
original Markdown input (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>). The text is
unprocessed; for example, HTML entities are left in <code class="docutils literal notranslate"><span class="pre">&amp;...;</span></code> form. If you were
writing your own rendering function, this callback would write the text to the
output stream (potentially after some translation).</p>
<p>Callbacks do not need to return anything specific—their return values are
ignored. To cancel parsing, callbacks can raise the <a class="reference internal" href="api.html#md4c.StopParsing" title="md4c.StopParsing"><code class="xref py py-class docutils literal notranslate"><span class="pre">StopParsing</span></code></a>
exception. The <a class="reference internal" href="api.html#md4c.GenericParser.parse" title="md4c.GenericParser.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parse()</span></code></a> method will catch it and
immediately halt parsing quietly. All other exceptions raised in callbacks will
abort parsing and propagate back to <a class="reference internal" href="api.html#md4c.GenericParser.parse" title="md4c.GenericParser.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parse()</span></code></a>’s caller.</p>
</section>
<section id="details-dicts">
<span id="details"></span><h3>Details Dicts<a class="headerlink" href="#details-dicts" title="Permalink to this headline">¶</a></h3>
<p>The block and span callbacks each accept a details dict. This is where extra
properties of the block or span are provided. The details available depend on
the type of block or span (and for some, it will be empty). Keys will always be
strings, and the values to expect are listed in the tables below.</p>
<p>Any block or span type for which there is no table will receive an empty
details dict.</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.BlockType.UL" title="md4c.BlockType.UL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">UL</span></code></a></span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 27%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'is_tight'</span></code></p></td>
<td><p>Bool</p></td>
<td><p>Whether the list is <a class="reference external" href="https://spec.commonmark.org/0.29/#tight">tight</a> or not</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'mark'</span></code></p></td>
<td><p>Single-char string</p></td>
<td><p>The character (<code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">+</span></code>)
used as a bullet point</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.BlockType.OL" title="md4c.BlockType.OL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">OL</span></code></a></span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 30%" />
<col style="width: 27%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'start'</span></code></p></td>
<td><p>Int</p></td>
<td><p>Start index of the ordered
list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'is_tight'</span></code></p></td>
<td><p>Bool</p></td>
<td><p>Whether the list is <a class="reference external" href="https://spec.commonmark.org/0.29/#tight">tight</a> or
not</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'mark_delimiter'</span></code></p></td>
<td><p>Single-char string</p></td>
<td><p>The character (<code class="docutils literal notranslate"><span class="pre">.</span></code>, <code class="docutils literal notranslate"><span class="pre">)</span></code>)
used as the number delimiter</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.BlockType.LI" title="md4c.BlockType.LI"><code class="xref py py-attr docutils literal notranslate"><span class="pre">LI</span></code></a></span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 27%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'is_task'</span></code></p></td>
<td><p>Bool</p></td>
<td><p>Whether the list item is a
task list item</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'task_mark'</span></code></p></td>
<td><p>Single-char string</p></td>
<td><p>The character (<code class="docutils literal notranslate"><span class="pre">X</span></code>,
<code class="docutils literal notranslate"><span class="pre">x</span></code>, space) used to mark
the task. Only present if
<code class="docutils literal notranslate"><span class="pre">'is_task'</span></code> is True.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'task_mark_offset'</span></code></p></td>
<td><p>Int</p></td>
<td><p>The offset of the task mark
character between the
<code class="docutils literal notranslate"><span class="pre">[]</span></code>. Only present if
<code class="docutils literal notranslate"><span class="pre">'is_task'</span></code> is True.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.BlockType.H" title="md4c.BlockType.H"><code class="xref py py-attr docutils literal notranslate"><span class="pre">H</span></code></a></span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 27%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'level'</span></code></p></td>
<td><p>Int</p></td>
<td><p>Heading level (1-6)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.BlockType.CODE" title="md4c.BlockType.CODE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CODE</span></code></a></span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 27%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'info'</span></code></p></td>
<td><p>Attribute*</p></td>
<td><p>Info string. Only present for
fenced code blocks.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'lang'</span></code></p></td>
<td><p>Attribute*</p></td>
<td><p>Language string. Only present for
fenced code blocks.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'fence_char'</span></code></p></td>
<td><p>Single-char string</p></td>
<td><p>Fence character (backtick or
tilde). None for indented code
blocks.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id7">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.BlockType.TABLE" title="md4c.BlockType.TABLE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TABLE</span></code></a></span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 30%" />
<col style="width: 21%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'col_count'</span></code></p></td>
<td><p>Int</p></td>
<td><p>Number of columns in the table</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'head_row_count'</span></code></p></td>
<td><p>Int</p></td>
<td><p>Number of rows in the table head</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'body_row_count'</span></code></p></td>
<td><p>Int</p></td>
<td><p>Number of rows in the table body</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.BlockType.TH" title="md4c.BlockType.TH"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TH</span></code></a> and <a class="reference internal" href="api.html#md4c.BlockType.TD" title="md4c.BlockType.TD"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TD</span></code></a></span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 30%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'align'</span></code></p></td>
<td><p><a class="reference internal" href="api.html#md4c.Align" title="md4c.Align"><code class="xref py py-class docutils literal notranslate"><span class="pre">md4c.Align</span></code></a></p></td>
<td><p>Cell alignment</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.SpanType.A" title="md4c.SpanType.A"><code class="xref py py-attr docutils literal notranslate"><span class="pre">A</span></code></a></span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 18%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'href'</span></code></p></td>
<td><p>Attribute*</p></td>
<td><p>Link URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'title'</span></code></p></td>
<td><p>Attribute*</p></td>
<td><p>Link title</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id10">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.SpanType.IMG" title="md4c.SpanType.IMG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">IMG</span></code></a></span><a class="headerlink" href="#id10" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 18%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'src'</span></code></p></td>
<td><p>Attribute*</p></td>
<td><p>Image URL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'title'</span></code></p></td>
<td><p>Attribute*</p></td>
<td><p>Image title</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id11">
<caption><span class="caption-text">Details dict for <a class="reference internal" href="api.html#md4c.SpanType.WIKILINK" title="md4c.SpanType.WIKILINK"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WIKILINK</span></code></a></span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 18%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'target'</span></code></p></td>
<td><p>Attribute*</p></td>
<td><p>Wikilink target</p></td>
</tr>
</tbody>
</table>
<p>* Attribute values are described below.</p>
</section>
<section id="attributes">
<span id="attribute"></span><h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<p>MD4C uses “attributes” for details that are text, such as link URLs and
fenced code block info strings. These are not allowed to contain any
span/inline elements, but they may contain HTML entities or null characters, so
attributes are how MD4C copes with this.</p>
<p>PyMD4C represents attributes as either <code class="docutils literal notranslate"><span class="pre">None</span></code> or a list of 2-tuples
<code class="docutils literal notranslate"><span class="pre">(text_type,</span> <span class="pre">text)</span></code> where <code class="docutils literal notranslate"><span class="pre">text_type</span></code> is a member of
<a class="reference internal" href="api.html#md4c.TextType" title="md4c.TextType"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextType</span></code></a> and <code class="docutils literal notranslate"><span class="pre">text</span></code> is the actual text as a <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code> (whichever one the Markdown input was).</p>
<p>For example, this string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Copyright</span> <span class="o">&amp;</span><span class="n">copy</span><span class="p">;</span> <span class="n">John</span> <span class="n">Doe</span>
</pre></div>
</div>
<p>would be represented as an attribute like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="n">md4c</span><span class="o">.</span><span class="n">TextType</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">,</span> <span class="s1">&#39;Copyright &#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="n">md4c</span><span class="o">.</span><span class="n">TextType</span><span class="o">.</span><span class="n">ENTITY</span><span class="p">,</span> <span class="s1">&#39;&amp;copy;&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="n">md4c</span><span class="o">.</span><span class="n">TextType</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">,</span> <span class="s1">&#39; John Doe&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Currently, the only <a class="reference internal" href="api.html#md4c.TextType" title="md4c.TextType"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextType</span></code></a> types allowed in an attribute are
<a class="reference internal" href="api.html#md4c.TextType.NORMAL" title="md4c.TextType.NORMAL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NORMAL</span></code></a>, <a class="reference internal" href="api.html#md4c.TextType.ENTITY" title="md4c.TextType.ENTITY"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ENTITY</span></code></a>, and
<a class="reference internal" href="api.html#md4c.TextType.NULLCHAR" title="md4c.TextType.NULLCHAR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">NULLCHAR</span></code></a>.</p>
</section>
</section>
<section id="entity-helper">
<h2>Entity Helper<a class="headerlink" href="#entity-helper" title="Permalink to this headline">¶</a></h2>
<p>PyMD4C provides a helper function <a class="reference internal" href="api.html#md4c.lookup_entity" title="md4c.lookup_entity"><code class="xref py py-func docutils literal notranslate"><span class="pre">lookup_entity()</span></code></a> to assist with
translating HTML entities to their corresponding UTF-8 character(s):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">md4c</span>

<span class="n">md4c</span><span class="o">.</span><span class="n">lookup_entity</span><span class="p">(</span><span class="s1">&#39;&amp;lt;&#39;</span><span class="p">)</span>  <span class="c1"># Returns &#39;&lt;&#39;</span>
</pre></div>
</div>
</section>
<section id="object-oriented-parsing">
<h2>Object-Oriented Parsing<a class="headerlink" href="#object-oriented-parsing" title="Permalink to this headline">¶</a></h2>
<p>PyMD4C provides a more object-oriented wrapper for <a class="reference internal" href="api.html#md4c.GenericParser" title="md4c.GenericParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericParser</span></code></a>
for applications which might find that useful: the <a class="reference internal" href="api.html#md4c.ParserObject" title="md4c.ParserObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParserObject</span></code></a>
class. This is a base class that defines the five callbacks as member
functions.</p>
<p>To use it, define a subclass that overrides the callback methods as necessary.
The constructor accepts the same arguments as <a class="reference internal" href="api.html#md4c.GenericParser" title="md4c.GenericParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericParser</span></code></a>
(unless it is overridden). Then, you can call the
<a class="reference internal" href="api.html#md4c.ParserObject.parse" title="md4c.ParserObject.parse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parse()</span></code></a> method, which only requires the Markdown input
as an argument.</p>
<p>Here is the same example program as above, implemented using a
<a class="reference internal" href="api.html#md4c.ParserObject" title="md4c.ParserObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParserObject</span></code></a> instead of <a class="reference internal" href="api.html#md4c.GenericParser" title="md4c.GenericParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericParser</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">md4c</span>

<span class="k">class</span> <span class="nc">CountingParser</span><span class="p">(</span><span class="n">md4c</span><span class="o">.</span><span class="n">ParserObject</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Pass parser options to ParserObject</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">block_counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">span_counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">enter_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_type</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">block_counts</span><span class="p">[</span><span class="n">block_type</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">block_counts</span><span class="p">[</span><span class="n">block_type</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">enter_span</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span_type</span><span class="p">,</span> <span class="n">details</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">span_counts</span><span class="p">[</span><span class="n">span_type</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">span_counts</span><span class="p">[</span><span class="n">span_type</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_type</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;README.md&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">markdown</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">CountingParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">markdown</span><span class="p">)</span>

<span class="k">for</span> <span class="n">block_type</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">block_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">block_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="k">for</span> <span class="n">span_type</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">span_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">span_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Characters&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">parser</span><span class="o">.</span><span class="n">char_count</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that using this paradigm, the counts can be instance variables instead
of global variables. And the callbacks for leaving blocks and spans can be
omitted entirely, since they were not necessary.</p>
<p>For more information, see the <a class="reference internal" href="api.html#md4c.ParserObject" title="md4c.ParserObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParserObject</span></code></a> API.</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="generating_html.html" title="Previous document">Generating HTML</a>
        </li>
        <li>
          <a href="dom_parsing.html" title="Next document">DOM Parsing</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy; Copyright 2021 Dominick C. Pastore.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/pure_parsing.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>